!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?e(require("jquery")):e(jQuery)}(function(e){"use strict";var t={className:"",text:"Drop a file",previewImage:!0,value:null,classes:{main:"ezdz-dropzone",enter:"ezdz-enter",reject:"ezdz-reject",accept:"ezdz-accept",focus:"ezdz-focus"},validators:{maxSize:null,width:null,maxWidth:null,minWidth:null,height:null,maxHeight:null,minHeight:null},init:function(){},enter:function(){},leave:function(){},reject:function(){},accept:function(){},format:function(e){return e}};e.ezdz=function(i,a){this.settings=e.extend(!0,{},t,e.ezdz.defaults,a),this.$input=e(i);var s=this,n=s.settings,r=s.$input;if(r.is('input[type="file"]')&&e.ezdz.isBrowserCompatible()){var d,l,o;l=e('<div class="'+n.classes.main+'" />').on("dragover.ezdz",function(){e(this).addClass(n.classes.enter),e.isFunction(n.enter)&&n.enter.apply(this)}).on("dragleave.ezdz",function(){e(this).removeClass(n.classes.enter),e.isFunction(n.leaved)&&n.leaved.apply(this)}).addClass(n.className),r.wrap(l).before("<div>"+n.text+"</div>"),d=r.parent("."+n.classes.main),(o=n.value||r.data("value"))&&s.preview(o),e.isFunction(n.init)&&n.init.apply(r,[o]),r.on("focus.ezdz",function(){d.addClass(n.classes.focus)}).on("blur.ezdz",function(){d.removeClass(n.classes.focus)}).on("change.ezdz",function(){var t=this.files[0];if(t){var i=t.name.replace(/\\/g,"/").replace(/.*\//,""),a=t.name.split(".").pop(),l=n.format(i);t.extension=a;var o=r.attr("accept"),c=!1,h=!0,p={mimeType:!1,maxSize:!1,width:!1,minWidth:!1,maxWidth:!1,height:!1,minHeight:!1,maxHeight:!1};if(o){var u=o.split(/[,|]/);e.each(u,function(i,s){return s=e.trim(s),"."+a===s?(c=!0,!1):t.type===s?(c=!0,!1):!1!==s.indexOf("/*")&&s.replace("/*","")===t.type.replace(/(\/.*)$/g,"")?(c=!0,!1):void 0}),!1===c&&(p.mimeType=!0)}else c=!0;if(d.removeClass(n.classes.reject+" "+n.classes.accept),!0!==c)return r.val(""),d.addClass(n.classes.reject),s.preview(null),e.isFunction(n.reject)&&n.reject.apply(r,[t,p]),!1;var f=new FileReader(t);f.readAsDataURL(t),f.onload=function(i){var a,o=new Image;t.data=i.target.result,o.src=t.data,setTimeout(function(){a=o.width&&o.height,n.validators.maxSize&&t.size>n.validators.maxSize&&(h=!1,p.maxSize=!0),a&&(t.width=o.width,t.height=o.height,n.validators.width&&o.width!==n.validators.width&&(h=!1,p.width=!0),n.validators.maxWidth&&o.width>n.validators.maxWidth&&(h=!1,p.maxWidth=!0),n.validators.minWidth&&o.width<n.validators.minWidth&&(h=!1,p.minWidth=!0),n.validators.height&&o.height!==n.validators.height&&(h=!1,p.height=!0),n.validators.maxHeight&&o.height>n.validators.maxHeight&&(h=!1,p.maxHeight=!0),n.validators.minHeight&&o.height<n.validators.minHeight&&(h=!1,p.minHeight=!0)),!0===h?(d.find("img").remove(),a&&!0===n.previewImage?d.find("div").html(e(o).fadeIn()):d.find("div").html("<span>"+l+"</span>"),d.addClass(n.classes.accept),e.isFunction(n.accept)&&n.accept.apply(r,[t])):(r.val(""),d.addClass(n.classes.reject),s.preview(null),e.isFunction(n.reject)&&n.reject.apply(r,[t,p]))},250)}}})}},e.ezdz.prototype.preview=function(t,i){var a=this.settings,s=this.$input,n=s.parent("."+a.classes.main),r=(t||"").replace(/\\/g,"/").replace(/.*\//,""),d=a.format(r);if(!t)return n.removeClass([a.classes.enter,a.classes.reject,a.classes.accept].join(" ")).find("div").html(a.text),void s.val("");var l=new Image;l.src=t,l.onload=function(){n.find("div").html(e(l).fadeIn()),e.isFunction(i)&&i.apply(this)},l.onerror=function(){n.find("div").html("<span>"+d+"</span>"),e.isFunction(i)&&i.apply(this)},n.addClass(a.classes.accept)},e.ezdz.prototype.destroy=function(){var e=this.settings,t=this.$input;t.parent("."+e.classes.main).replaceWith(t),t.off("*.ezdz"),t.removeData("ezdz")},e.ezdz.prototype.options=function(t){var i=this.settings;if(!t)return i;e.extend(!0,this.settings,t)},e.ezdz.prototype.container=function(){var e=this.settings;return this.$input.parent("."+e.classes.main)},e.ezdz.isBrowserCompatible=function(){return!!(window.File&&window.FileList&&window.FileReader)},e.ezdz.defaults=t,e.fn.ezdz=function(t){var i,a=arguments;return this.each(function(){return(i=e(this).data("ezdz"))?i[t]?i[t].apply(i,Array.prototype.slice.call(a,1)):void e.error("Ezdz error - Method "+t+" does not exist."):e(this).data("ezdz",new e.ezdz(this,t))})}});
